/*!
 * p5ui.js v1.0.0 July 23, 2020 - by Saksham Shah
 * 
 */!function(t){var e={};function i(s){if(e[s])return e[s].exports;var h=e[s]={i:s,l:!1,exports:{}};return t[s].call(h.exports,h,h.exports,i),h.l=!0,h.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var h in t)i.d(s,h,function(e){return t[e]}.bind(null,h));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";i.r(e);class s{constructor(t){this.screenPosition={x:0,y:0,z:1},this.width=t.width||900,this.height=t.height||600,this.buffer=t.buffer||.9,this.overlayHeader=t.overlayHeader||30,this.overlayPadding=t.overlayPadding||5,this.tooltipHeight=t.tooltipHeight||25,this.tooltipPadding=t.tooltipPadding||5,this.tooltipTextSize=this.tooltipHeight-2*this.tooltipPadding,this.screen=null,this.overlays=[],this.screens=new Map,this.labelledElements=new Map,this.textboxes=[],this.themes=new Map,this.theme="default",this.sounds={}}setupUI(){rectMode(CENTER),this.resizeUI(),this.setTheme("default"),this.cursor=new s.Cursor(this),this.cursors={};let t=this;document.addEventListener("keydown",e=>{"Tab"!=e.key&&"Alt"!=e.key||e.preventDefault(),t.getActiveScreen().emit("keyType",e),t.cursor.showTooltip=!1}),canvas.addEventListener("wheel",e=>{t.getActiveScreen().emit("mouseWheel",e),t.cursor.showTooltip=!1}),window.mousePressed=e=>(t.getActiveScreen().emit("mouseDown",e),t.cursor.showTooltip=!1,!1),window.mouseReleased=e=>(t.getActiveScreen().emit("mouseUp",e),!1),window.keyPressed=e=>{"Escape"==e.key&&this.overlays.length>0?this.closeOverlay():(t.getActiveScreen().emit("keyDown",e),t.cursor.showTooltip=!1)},window.keyReleased=e=>{t.getActiveScreen().emit("keyUp",e)}}addScreen(t,e={}){e.p5ui=this;let i=new s.Screen(e);return this.screens.set(t,i),i}addOverlay(t,e={}){e.p5ui=this;let i=new s.Overlay(e);return this.screens.set(t,i),i}getScreen(t){return this.screens.get(t)}setScreen(t){let e=this.screen,i=this.getScreen(t);if(null!=i)return this.screen=i,null!=e&&e._changeScreen(!0,e,i),i._changeScreen(!1,e,i),i;console.warn(` Failed to change screen - '${t}' does not exist.`)}openOverlay(t,...e){let i=this.getScreen(t);if(null==i)return void console.warn(` Failed to open overlay - '${t}' does not exist.`);let s=this.getActiveScreen();this.overlays.push(i),i.onDisplay(...e),s._changeScreen(!0,s,i),i._changeScreen(!1,s,i)}closeOverlay(){if(this.overlays.length>0){let t=this.overlays.pop(),e=this.getActiveScreen();t._changeScreen(!0,t,e),e._changeScreen(!1,t,e)}}closeAllOverlays(){for(;this.overlays.length>0;)this.closeOverlay()}getActiveScreen(){return 0==this.overlays.length?this.screen:this.overlays[this.overlays.length-1]}addElement(t,e){this.labelledElements.set(e,t)}getElement(t){return this.labelledElements.get(t)}updateUI(){this.cursor.update();let t=this.getActiveScreen();t._update(this.cursor.mousePos),this.cursor.setMode(t._getCursorState())}drawUI(){let t=this.screen.getColour("background");if(-1!=t?background(t):clear(),push(),translate(this.screenPosition.x,this.screenPosition.y),scale(this.screenPosition.z),this.screen._show(),this.overlays.length>0){noStroke();let t=this.overlays[this.overlays.length-1],e=t.getColour("background");-1!=e&&(fill(e),rect(.5*this.width,.5*this.height,this.width,this.height)),t._show()}let e=this.screen.getColour("stroke");-1!=e&&(noFill(),stroke(e),strokeWeight(4),rect(.5*this.width,.5*this.height,this.width,this.height)),pop();let i=this.screen.getColour("outer");if(-1!=i&&(fill(i),noStroke(),rect(.5*width,.5*this.screenPosition.y,width,this.screenPosition.y),rect(.5*width,height-.5*this.screenPosition.y,width,this.screenPosition.y),rect(.5*this.screenPosition.x,.5*height,this.screenPosition.x,height),rect(width-.5*this.screenPosition.x,.5*height,this.screenPosition.x,height)),this.cursor.timeSinceMovement>30){let t=this.getActiveScreen().getTooltip();t.length>0&&this.drawTooltip(t)}}drawTooltip(t){push(),translate(mouseX+10,mouseY+10),scale(this.screenPosition.z);let e=!1;noFill();let i=this.screen.getColour("fill","tooltip",!1);-1!=i&&(fill(i),e=!0),noStroke();let s=this.screen.getColour("stroke","tooltip",!1);if(-1!=s&&(stroke(s),strokeWeight(1),e=!0),textSize(this.tooltipTextSize),e){let e=textWidth(t)+2*this.tooltipPadding,i=this.tooltipTextSize+2*this.tooltipPadding;rect(.5*e,.5*i,e,i)}textAlign(LEFT),noStroke(),fill(this.screen.getColour("text","tooltip",!1)),text(t,this.tooltipPadding,this.tooltipPadding+5*this.tooltipTextSize/6),pop()}resizeUI(){let t=width/height,e=this.width/this.height;this.screenPosition.z=t>e?height/this.height*this.buffer:width/this.width*buffer,this.screenPosition.x=.5*(width-this.width*this.screenPosition.z),this.screenPosition.y=.5*(height-this.height*this.screenPosition.z)}setFont(t){textFont(t);for(let t of this.textboxes)t.clipText()}setCursors(t){this.cursors=t}setSounds(t){this.sounds=t}addTheme(t,e,i=!1){this.themes.set(t,e),i&&this.setTheme(t)}setTheme(t){this.theme=t,this.resetStyles()}resetStyles(){for(let t of this.screens.values())t._setStyle()}getStyle(t,e){let i=this.themes.get(this.theme);if(null!=i&&null!=i[e]){if(null!=i[e][t])return i[e][t];console.warn(`Failed to get style - style '${t}' does not exist for ${e} element.`)}}}var h=s;h.Element=class{constructor(t={},e){this.pos=t.position||{x:0,y:0},this.p5ui=t.p5ui,this.type=e,this.hidden=null!=t.hidden&&t.hidden,this.parent=null,this.children=[],this.styleName=t.style,this.mousePos={x:0,y:0},this.tooltip=null==t.tooltip?null:t.tooltip,this.events=new Map,this.userDefinedEvents={update:t.update,draw:t.draw,postDraw:t.postDraw,getCursorState:t.getCursorState,changeScreen:t.changeScreen},this.label=t.label}emit(t,e){if(!this.hidden){for(let i of this.children)i.emit(t,e);null!=this[t]&&this[t](e),this.events.has(t)&&this.events.get(t)(e,this)}}on(t,e){return this.events.set(t,e),this}hide(t){return this.hidden=null!=t?t:!this.hidden,this}addChild(t){this.children.push(t),t.parent=this,null!=t.label&&this.p5ui.addElement(t,t.label)}getElements(){return this.children}getParent(){if(this.parent)return this.parent}_update(t){if(!this.hidden){0!=this.pos.x||0!=this.pos.y?this.mousePos={x:t.x-this.pos.x,y:t.y-this.pos.y}:this.mousePos=t;for(let t of this.children)t._update(this.mousePos);this.update(this.mousePos),null!=this.userDefinedEvents.update&&this.userDefinedEvents.update()}}update(){}isHovered(){return!1}_getCursorState(){if(this.hidden)return;let t;for(let e of this.children)null==t&&(t=e._getCursorState());if(null!=this.userDefinedEvents.getCursorState){let e=this.userDefinedEvents.getCursorState(t);if(null!=e)return e}let e=this.getCursorState(t);return null!=e?e:t}getCursorState(){}_changeScreen(t,e,i){for(let s of this.children)s._changeScreen(t,e,i);this.changeScreen(t,e,i),null!=this.userDefinedEvents.changeScreen&&this.userDefinedEvents.changeScreen(t,e,i)}changeScreen(){}_show(){if(!this.hidden){push(),0==this.pos.x&&0==this.pos.y||translate(this.pos.x,this.pos.y),this.show(),null!=this.userDefinedEvents.draw&&this.userDefinedEvents.draw();for(let t of this.children)t._show();this.postShow(),null!=this.userDefinedEvents.postDraw&&this.userDefinedEvents.postDraw(),pop()}}show(){}postShow(){}_setStyle(t="default"){let e=this.styleName||t;this.style=this.p5ui.getStyle(e,this.type);for(let t of this.children)t._setStyle(e)}getColour(t,e,i=!0){if(null==this.style)return-1;if(null!=e){if(null!=this.style[e]&&null!=this.style[e][t])return this.style[e][t];if(!i)return-1}return null!=this.style[t]?this.style[t]:-1}getTooltip(){if(this.hidden)return"";for(let t of this.children){let e=t.getTooltip();if(e.length>0)return e}if(this.tooltip&&this.showTooltip()){let t=this.tooltip;if(t instanceof Function&&(t=t()),t)return t}return""}showTooltip(){return this.isHovered(this.mousePos)}addButton(t){t.p5ui=this.p5ui;let e=new h.Button(t);return this.addChild(e),this}addContainer(t){t.p5ui=this.p5ui;let e=new h.Container(t);return this.addChild(e),this}addTextbox(t){t.p5ui=this.p5ui;let e=new h.Textbox(t);return this.addChild(e),this.p5ui.textboxes.push(e),this}addChatbox(t){t.p5ui=this.p5ui;let e=new h.Chatbox(t);return this.addChild(e),this}addTable(t){t.p5ui=this.p5ui;let e=new h.Table(t);return this.addChild(e),this}addCheckbox(t){t.p5ui=this.p5ui;let e=new h.Checkbox(t);return this.addChild(e),this}addSlider(t){t.p5ui=this.p5ui;let e=new h.Slider(t);return this.addChild(e),this}};var o=h.Element;h.Cursor=class{constructor(t){this.p5ui=t,this.onScreen=!1,this.mode="default",this.img="default",this.mousePos={x:0,y:0},this.timeSinceMovement=0,this.showTooltip=!1}update(){let t=this.getScreenPos();mouseIsPressed||t.x!=this.mousePos.x||t.y!=this.mousePos.y?(this.timeSinceMovement=0,this.showTooltip=!0):this.showTooltip?this.timeSinceMovement++:this.timeSinceMovement=0,this.mousePos=t,this.isOnScreen()?this.onScreen||(this.onScreen=!0,cursor(this.img)):this.onScreen&&(this.onScreen=!1,cursor("default"))}setMode(t="default"){t!=this.mode&&(this.mode=t,this.img=this.p5ui.cursors[t],null==this.img&&(this.img=t),this.onScreen&&cursor(this.img))}isOnScreen(){return mouseX>this.p5ui.screenPosition.x&&mouseY>this.p5ui.screenPosition.y&&mouseX<width-this.p5ui.screenPosition.x&&mouseY<height-this.p5ui.screenPosition.y}getScreenPos(){return{x:(mouseX-this.p5ui.screenPosition.x)/this.p5ui.screenPosition.z,y:(mouseY-this.p5ui.screenPosition.y)/this.p5ui.screenPosition.z}}};h.Cursor;h.Button=class extends o{constructor(t={}){super(t,"button"),this.width=t.width||200,this.height=t.height||100,this.text=t.text||"",this.tSize=t.textSize||50,this.onClick=t.onClick||(()=>{}),this.target=t.target||{},this.hovered=!1,this.clickPos=null}update(){this.isHovered()?this.hovered||(this.hovered=!0,this.p5ui.sounds.hover.play()):this.hovered=!1}getCursorState(){if(this.hovered)return"pointer"}mouseDown(t){0==t.button&&(this.clickPos=this.mousePos)}mouseUp(t){if(0==t.button)return!(!this.hovered||!this.isHovered(this.clickPos))&&(this.click(),!0)}click(){this.onClick(this,this.target),this.p5ui.sounds.click.play()}isHovered(t=this.mousePos){return t.x>.5*-this.width&&t.y>.5*-this.height&&t.x<.5*this.width&&t.y<.5*this.height}show(){let t,e;t=this.hovered?this.getColour("fill","hover"):this.getColour("fill"),-1!=t?fill(t):noFill(),e=this.hovered?this.getColour("stroke","hover"):this.getColour("stroke"),-1!=e?(stroke(e),strokeWeight(1)):noStroke(),rect(0,0,this.width,this.height),textAlign(CENTER),textSize(this.tSize),this.hovered?fill(this.getColour("text","hover")):fill(this.getColour("text")),noStroke();let i=this.text;i instanceof Function&&(i=i(this,this.target)),text(i,0,this.tSize/3)}};var r=h.Button;function l(t,e){if(textWidth(t)<=e)return[t,""];let i=0,s="";for(;i<t.length&&textWidth(s+t[i])<=e;)s+=t[i],i++;return[s,t.substring(i)]}h.Chatbox=class extends o{constructor(t={}){if(super(t,"chatbox"),this.padding=t.padding||5,this.width=t.width||400,this.lineHeight=t.lineHeight||25,this.textSize=this.lineHeight-2*this.padding,this.height=t.height||250,this.maxLines=Math.floor(this.height/this.lineHeight),this.scrollbar=null,this.scrollbarWidth=t.scrollbarWidth||0,this.scrollbarWidth>0){let t={position:{x:this.width-this.scrollbarWidth,y:0},p5ui:this.p5ui,barWidth:this.scrollbarWidth,reverseScroll:!0};this.scrollbar=new h.Scrollbar(this.height,this.maxLines,"lines","displayStart",t),this.addChild(this.scrollbar)}this.width-=this.scrollbarWidth,this.textW=this.width-2*this.padding,this.lines=[],this.displayStart=0}addText(t,e){let i=function(t,e,i){push(),textSize(e);let s,h=t.split(" "),o="",r=[],n="";for(;h.length>0;){let t=h.splice(0,1)[0];if(n=o+t,h.length>0&&(n+=" "),s=textWidth(n),s>i)if(""==o){let[e,s]=l(t,i);r.push(e),s.length>0&&h.unshift(s)}else r.push(o),o="",h.unshift(t);else o=n}return r.push(o),pop(),r}(t,this.textSize,this.textW);for(let t of i)this.lines.unshift({text:t,bold:e});this.scrollbar&&this.scrollbar.scroll(-this.displayStart)}toggleScrollbar(t){this.scrollbar&&(this.displayStart=0,this.scrollbar.toggleScrollbar(t),this.scrollbar.calculateScrollbar())}clear(){this.lines=[],this.displayStart=0,this.scrollbar&&this.scrollbar.calculateScrollbar()}isHovered(t=this.mousePos){return t.x>0&&t.y>-this.height&&t.x<this.width+(this.scrollbar?this.scrollbar.barWidth:0)&&t.y<0}changeScreen(t){t?this.hide(!0):this.hide(!1)}show(){let t=Math.min(this.lines.length,this.maxLines),e=this.displayStart;e+t>this.lines.length&&(e=0);let i={fill:{default:this.getColour("fill"),bold:this.getColour("fill","bold")},stroke:{default:this.getColour("stroke"),bold:this.getColour("stroke","bold")},text:{default:this.getColour("text"),bold:this.getColour("text","bold")}};textAlign(LEFT),textSize(this.textSize);for(let e=this.displayStart;e<this.displayStart+t;e++){let t=this.lines[e];if(""==t.text)continue;push(),translate(0,-this.lineHeight*(e-this.displayStart));let s,h,o=!1;if(noFill(),s=t.bold?i.fill.bold:i.fill.default,-1!=s&&(fill(s),o=!0),noStroke(),h=t.bold?i.stroke.bold:i.stroke.default,-1!=h&&(stroke(h),strokeWeight(1),o=!0),o){let e=textWidth(t.text)+2*this.padding;rect(.5*e,.5*-this.lineHeight,e,this.lineHeight)}noStroke(),t.bold?fill(i.text.bold):fill(i.text.default),text(t.text,this.padding,-.5*this.lineHeight+this.textSize/3),pop()}}};h.Chatbox;h.Checkbox=class extends o{constructor(t={}){super(t,"checkbox"),this.size=t.size||30,this.value=null!=t.value&&t.value,this.onClick=t.onClick||(()=>{}),this.hovered=!1}update(){this.isHovered()?this.hovered||(this.hovered=!0,this.p5ui.sounds.hover.play()):this.hovered=!1}getCursorState(){if(this.hovered)return"pointer"}mouseDown(t){0==t.button&&this.hovered&&(this.value=!this.value,this.onClick(this.value),this.p5ui.sounds.click.play())}isHovered(t=this.mousePos){return t.x>.5*-this.size&&t.y>.5*-this.size&&t.x<.5*this.size&&t.y<.5*this.size}show(){let t=this;function e(e){let i=-1;return t.hovered?(t.value&&(i=t.getColour(e,"hoverchecked",!1),-1==i&&(i=t.getColour(e,"checked",!1))),-1==i&&(i=t.getColour(e,"hover"))):i=t.value?t.getColour(e,"checked"):t.getColour(e),i}noFill(),noStroke();let i=!1,s=e("fill"),h=e("stroke");if(-1!=s&&(fill(s),i=!0),-1!=h&&(stroke(h),strokeWeight(2),i=!0),i&&rect(0,0,this.size,this.size),!this.value)return;let o=e("tick");-1!=o&&stroke(o),-1==o&&-1==h||-2==o||(noFill(),strokeWeight(this.size/6),beginShape(),vertex(.3*-this.size,0),vertex(.15*-this.size,.15*this.size),vertex(.3*this.size,.3*-this.size),endShape())}};h.Checkbox;h.CloseButton=class extends r{constructor(t){let e=.5*-t.header;super({position:{x:t.width+e,y:e},p5ui:t.p5ui,width:t.textSize,height:t.textSize,onClick:()=>t.p5ui.closeOverlay()}),this.type="closebutton"}show(){let t,e;t=this.hovered?this.getColour("fill","hover"):this.getColour("fill"),-1!=t?fill(t):noFill(),e=this.hovered?this.getColour("stroke","hover"):this.getColour("stroke"),-1!=e?(stroke(e),strokeWeight(2)):noStroke(),rect(0,0,this.width,this.height),strokeWeight(2),this.hovered?stroke(this.getColour("cross","hover")):stroke(this.getColour("cross"));let i=.3*this.width;line(-i,i,i,-i),line(i,i,-i,-i)}};h.CloseButton;h.Container=class extends o{constructor(t){super(t,"container"),this.width=t.width||300,this.height=t.height||200,this.text=t.text||"",this.padding=t.padding||5,this.header=t.header||25,this.textSize=this.header-2*this.padding,this.clickPos={x:0,y:0},this.mousePressed=!1}mouseUp(t){this.mousePressed=!1}isHovered(t=this.mousePos){return 0!=this.text.length&&(t.x>0&&t.y>-this.header&&t.x<this.width&&t.y<0)}show(){if(this.width>0&&this.height>0){let t=this.getColour("fill");-1!=t?fill(t):noFill();let e=this.getColour("stroke");-1!=e?(stroke(e),strokeWeight(1)):noStroke(),rect(.5*this.width,.5*this.height,this.width,this.height)}if(this.header>0&&this.text.length>0){let t=this.getColour("header");-1!=t&&(fill(t),rect(.5*this.width,.5*-this.header,this.width,this.header)),textAlign(CENTER),textSize(this.textSize),noStroke(),fill(this.getColour("text")),text(this.text,.5*this.width,.5*-this.header+this.textSize/3)}}};h.Container;h.Overlay=class extends o{constructor(t={}){let e=t.width||t.p5ui.width,i=t.height||t.p5ui.height;t.position={x:.5*(t.p5ui.width-e),y:.5*(t.p5ui.height-i)},super(t,"overlay"),this.width=e,this.height=i,this.text=t.text||"",this.drawBox=0!=t.drawBox,this.header=this.p5ui.overlayHeader,this.textSize=this.header-2*this.p5ui.overlayPadding,this.onDisplay=t.onDisplay||(()=>{}),this.text.length>0&&this.addChild(new h.CloseButton(this))}show(){if(this.drawBox,this.text.length>0){let t=this.getColour("fill");-1!=t?fill(t):noFill(),noStroke(),rect(.5*this.width,.5*this.height,this.width,this.height);let e=this.getColour("header");-1!=e&&(fill(e),rect(.5*this.width,.5*-this.header,this.width,this.header)),textAlign(CENTER),textSize(this.textSize),noStroke(),fill(this.getColour("text")),text(this.text,.5*this.width,.5*-this.header+this.textSize/3)}}postShow(){if(this.text.length>0){noFill();let t=this.getColour("stroke");-1!=t?(stroke(t),strokeWeight(1)):noStroke(),rect(.5*this.width,.5*this.height,this.width,this.height),-1!=this.getColour("header")&&rect(.5*this.width,.5*-this.header,this.width,this.header)}}};h.Overlay;h.Screen=class extends o{constructor(t){super(t,"screen")}isHovered(){return this.p5ui.cursor.isOnScreen()}};h.Screen;h.Scrollbar=class extends o{constructor(t,e,i,s,h={}){super(h,"scrollbar"),this.height=t,this.maxRows=e,this.rowContents=i,this.scrollProperty=s,this.rowWidth=h.rowWidth||0,this.barWidth=h.barWidth||10,this.scrollDirection=h.reverseScroll?-1:1,this.scrollPosition=0,this.scrollHeight=1,this.scrollY=0,this.hovered=!1,this.mousePressed=!1,this.clickStart=0,this.positionAtClick=0}update(t){if(this.hovered=this.isHovered()||this.mousePressed,this.mousePressed){let t=this.parent[this.rowContents].length,e=Math.min(t,this.maxRows),i=(this.mousePos.y-this.clickStart)*this.scrollDirection,s=i>0,h=Math.floor(Math.abs(i)*t/this.height);s||(h*=-1);let o=this.positionAtClick+h;o<0&&(o=0),o>t-e&&(o=t-e),this.parent[this.scrollProperty]=o,this.calculateScrollbar()}}mouseDown(t){1!=this.scrollHeight&&this.isHovered()&&(this.mousePressed=!0,this.clickStart=this.mousePos.y,this.positionAtClick=this.parent[this.scrollProperty])}mouseWheel(t){this.mousePressed||this.parent.isHovered()&&this.scroll(t.deltaY/100*this.scrollDirection)}mouseUp(t){this.mousePressed=!1}scroll(t){if(this.hidden)return;let e=this.parent[this.rowContents].length;this.parent[this.scrollProperty]+=t;let i=Math.min(e,this.maxRows);this.parent[this.scrollProperty]<0?(t-=this.parent[this.scrollProperty],this.parent[this.scrollProperty]=0):this.parent[this.scrollProperty]>e-i&&(t+=e-i-this.parent[this.scrollProperty],this.parent[this.scrollProperty]=e-i),this.calculateScrollbar()}calculateScrollbar(){if(this.hidden)return;let t=this.parent[this.rowContents].length;if(0==t)return this.scrollHeight=1,this.scrollY=0,void(this.mousePressed=!1);this.scrollHeight=Math.min(this.maxRows/t,1),1==this.scrollHeight&&(this.mousePressed=!1),this.scrollY=this.parent[this.scrollProperty]/t*this.scrollDirection}toggleScrollbar(t){this.hide(t),this.hidden&&(this.mousePressed=!1),this.calculateScrollbar()}isHovered(t=this.mousePos){let e=t.y*this.scrollDirection;return t.x>0&&e>this.scrollY*this.height*this.scrollDirection&&t.x<this.barWidth&&e<this.scrollY*this.height*this.scrollDirection+this.scrollHeight*this.height}reset(){this.parent[this.scrollProperty]=0,this.calculateScrollbar()}changeScreen(t){t&&(this.mousePressed=!1)}show(){if(push(),this.scrollHeight<1){let t,e;t=this.hovered?this.getColour("fill","hover"):this.getColour("fill"),-1!=t?fill(t):noFill(),e=this.hovered?this.getColour("stroke","hover"):this.getColour("stroke"),-1!=e?(stroke(e),strokeWeight(1)):noStroke();let i=0,s=this.scrollY*this.height,h=this.barWidth,o=this.scrollHeight*this.height;rect(i+.5*h,s+.5*o*this.scrollDirection,h,o)}pop()}};h.Scrollbar;h.Slider=class extends o{constructor(t={}){super(t,"slider"),this.width=t.width||300,this.height=t.height||10,this.radius=t.radius||20,this.textSize=t.textSize||0,this.min=t.min||0,this.max=t.max||1,this.max<this.min&&console.error(`Slider: max value (${this.max}) is less than min value (${this.min}).`),this.value=null==t.value?(this.max+this.min)/2:t.value,this.value<this.min&&(this.value=this.min),this.value>this.max&&(this.value=this.max),this.calculateXPosition(),this.increment=t.increment||1,this.scrollSpeed=t.scrollSpeed||this.increment,this.onMove=t.onMove||(()=>{}),this.onRelease=t.onRelease||(()=>{}),this.hovered=!1,this.mouseIsPressed=!1,this.clickStart=0}update(){if(this.isHovered()||this.mouseIsPressed?this.hovered||(this.hovered=!0,this.p5ui.sounds.hover.play()):this.hovered=!1,this.mouseIsPressed){let t=(this.mousePos.x/this.width+.5)*(this.max-this.min)+this.min;t=Math.round(t/this.increment)*this.increment,t<this.min&&(t=this.min),t>this.max&&(t=this.max),this.value!=t&&(this.value=t,this.calculateXPosition(),this.onMove(this.value))}}getCursorState(){if(this.hovered)return"pointer"}mouseDown(t){0==t.button&&this.isHovered()&&(this.mouseIsPressed=!0,this.clickStart=this.mousePos.x)}mouseUp(t){0==t.button&&this.mouseIsPressed&&(this.mouseIsPressed=!1,this.onRelease(this.value))}mouseWheel(t){if(this.mouseIsPressed||!this.isHovered())return;let e=this.value-t.deltaY*this.scrollSpeed/100;e<this.min&&(e=this.min),e>this.max&&(e=this.max),this.value!=e&&(this.value=e,this.calculateXPosition(),this.onMove(this.value))}isHovered(t=this.mousePos){return t.x>.5*-this.width-this.radius&&t.y>-this.radius&&t.x<.5*this.width+this.radius&&t.y<this.radius}calculateXPosition(){let t=(this.value-this.min)/(this.max-this.min);this.xPosition=this.width*(t-.5)}show(){let t,e,i;t=this.hovered?this.getColour("line","hover"):this.getColour("line"),-1!=t&&(stroke(t),noFill(),strokeWeight(this.height),line(.5*-this.width,0,.5*this.width,0)),e=this.hovered?this.getColour("circle","hover"):this.getColour("circle"),-1!=e&&(fill(e),noStroke(),ellipse(this.xPosition,0,2*this.radius)),0!=this.textSize&&(i=this.hovered?this.getColour("text","hover"):this.getColour("text"),fill(i),noStroke(),textSize(this.textSize),textAlign(CENTER),text(this.value,this.xPosition,this.textSize/3))}};h.Slider;h.Table=class extends o{constructor(t={}){if(super(t,"table"),this.padding=t.padding||5,this.width=t.width||800,this.rowHeight=t.rowHeight||30,this.textSize=this.rowHeight-2*this.padding,this.height=t.height||300,this.maxRows=Math.floor(this.height/this.rowHeight),this.scrollbar=null,this.scrollbarWidth=t.scrollbarWidth||0,this.scrollbarWidth>0){let t={position:{x:this.width-this.scrollbarWidth,y:0},p5ui:this.p5ui,barWidth:this.scrollbarWidth};this.scrollbar=new h.Scrollbar(this.height,this.maxRows,"rows","displayStart",t),this.addChild(this.scrollbar)}if(this.columnWidths=t.columnWidths||[],this.columnTitles=t.columnTitles||[],this.columnData=t.columnData||[],0==this.columnData.length)throw new Error("Table must have at least one column");if(0==this.columnWidths.length){let t=(this.width-this.scrollbarWidth)/this.columnData.length;for(let e=0;e<this.columnData.length;e++)this.columnWidths.push(t)}this.width=this.scrollbarWidth;for(let t=0;t<this.columnWidths.length;t++)this.width+=this.columnWidths[t];this.onClick=t.onClick||(()=>{}),this.hasClick=!0,null==t.onClick&&(this.hasClick=!1),this.rows=[],this.displayStart=0,this.hoveredRow=-1}update(){if(this.hasClick){let t=this.getHoveredRow();-1!=t&&this.hoveredRow!=t&&this.p5ui.sounds.hover.play(),this.hoveredRow=t}}getCursorState(){if(-1!=this.hoveredRow)return"pointer"}mouseDown(t){0==t.button&&(this.clickedRow=this.hoveredRow)}mouseUp(t){if(0==t.button&&-1!=this.hoveredRow)return this.hoveredRow==this.clickedRow&&(this.onClick(this.rows[this.hoveredRow]),this.p5ui.sounds.click.play(),!0)}addItem(t){this.rows.push(t),this.scrollbar&&this.scrollbar.calculateScrollbar()}clear(){this.rows=[],this.displayStart=0,this.scrollbar&&this.scrollbar.calculateScrollbar()}isHovered(t=this.mousePos){return t.x>0&&t.y>0&&t.x<this.width&&t.y<this.height}getHoveredRow(t=this.mousePos){if(t.x<0||t.x>this.width-this.scrollbarWidth||t.y<0||t.y>this.height)return-1;let e=Math.min(this.rows.length,this.maxRows),i=this.displayStart;i+e>this.rows.length&&(i=0);let s=Math.floor(t.y/this.rowHeight)+this.displayStart;return s>=this.rows.length&&(s=-1),s}changeScreen(t){t&&(this.hoveredRow=-1)}show(){noStroke(),textSize(this.textSize);let t=this.getColour("fill","header");-1!=t&&(fill(t),rect(.5*this.width,.5*-this.rowHeight,this.width,this.rowHeight)),textAlign(CENTER),fill(this.getColour("text","header"));let e=0;for(let t=0;t<this.columnData.length&&t<this.columnTitles.length;t++){let i=e;0==t?(textAlign(LEFT),i+=this.padding):(1==t&&textAlign(CENTER),i+=.5*this.columnWidths[t]);let s=this.columnTitles[t];if(textWidth(s)>this.columnWidths[t]-2*this.padding){let e=Math.floor((this.columnWidths[t]-2*this.padding)/textWidth(" "))-3;s=s.substring(0,e)+"..."}text(s,i,.5*-this.rowHeight+this.textSize/3),e+=this.columnWidths[t]}let i=Math.min(this.rows.length,this.maxRows),s=this.displayStart;s+i>this.rows.length&&(s=0);let h=this.getColour("fill");-1!=h&&(fill(h),rect(.5*this.width,.5*this.height,this.width,this.height));let o=this.width-this.scrollbarWidth,r=this.getColour("fill","alternate");if(-1!=r&&r!=h){fill(r);for(let t=1-this.displayStart%2;t<this.maxRows;t+=2){let e=t*this.rowHeight;rect(.5*o,e+.5*this.rowHeight,o,this.rowHeight)}}if(this.hoveredRow>=s&&this.hoveredRow<s+i){let t=this.getColour("fill","hover");-1!=t&&(fill(t),rect(.5*o,this.rowHeight*(this.hoveredRow-this.displayStart)+.5*this.rowHeight,o,this.rowHeight))}let l={default:this.getColour("text"),alternate:this.getColour("text","alternate"),hover:this.getColour("text","hover")},n=0;for(let t=this.displayStart;t<this.displayStart+i;t++){t==this.hoveredRow&&-1!=l.hover?fill(l.hover):t%2==1&&-1!=l.alternate?fill(l.alternate):fill(l.default);let e=0;for(let i=0;i<this.columnData.length;i++){let s=e;0==i?(textAlign(LEFT),s+=this.padding):(1==i&&textAlign(CENTER),s+=.5*this.columnWidths[i]);let h=this.rows[t][this.columnData[i]];if(textWidth(h)>this.columnWidths[i]-2*this.padding){let t=Math.floor((this.columnWidths[i]-2*this.padding)/textWidth(" "))-3;h=h.substring(0,t)+"..."}text(h,s,n+.5*this.rowHeight+this.textSize/3),e+=this.columnWidths[i]}n+=this.rowHeight}}postShow(){let t=this.getColour("stroke");if(-1!=t){stroke(t),noFill(),strokeWeight(1);let e=this.height+this.rowHeight;rect(.5*this.width,-this.rowHeight+.5*e,this.width,e)}}};h.Table;h.Textbox=class extends o{constructor(t={}){super(t,"textbox"),this.padding=t.padding||5,this.width=t.width||400,this.textW=this.width-2*this.padding,this.height=t.height||25,this.textSize=this.height-2*this.padding,this.onSubmit=t.onSubmit||(()=>{}),this.onFocus=t.onFocus||(()=>{}),this.onBlur=t.onBlur||(()=>{}),this.clickToFocus=null==t.clickToFocus||t.clickToFocus,this.allowEmptySubmit=null!=t.allowEmptySubmit&&t.allowEmptySubmit,this.clearOnSubmit=null==t.clearOnSubmit||t.clearOnSubmit,this.blurOnSubmit=null==t.blurOnSubmit||t.blurOnSubmit,this.default=t.default||"",this.value=t.value||"",this.maxLength=t.maxLength||0,this.focused=!1,this.timeSinceMoved=0,this.cursorPos=this.value.length,this.visibleText=[0,this.value.length],this.visibleTextString=this.value,this.visibleTextWidth=0,this.fixedLeft=!0,this.selection=!1,this.selectedText=[0,0],this.selectionAnchor=0,this.selectionStart=this.cursorPos,this.mousePressed=!1,this.shiftPressed=!1,this.keyQueue=[],this.pasting=!1}update(){if(this.focused&&(this.timeSinceMoved++,!this.pasting)){for(let t of this.keyQueue)this.typeKey(t);if(this.keyQueue=[],this.mousePressed){let t=this.clickPos(this.mousePos);this.selection||t!=this.selectionAnchor&&(this.selection=!0,this.selectedText[0]=this.selectionAnchor,this.selectedText[1]=t),this.moveCursor(t-this.cursorPos,this.shiftPressed||this.selection)}}}getCursorState(){if(this.isHovered(this.mousePos)&&(this.focused||this.clickToFocus))return"text"}mouseDown(t){this.isHovered()?this.clickToFocus&&!this.focused&&(this.focus(),this.cursorPos=this.clickPos(this.mousePos),this.clipText(),this.selection=!1,this.selectionStart=this.cursorPos):this.focused&&this.blur(),this.focused&&(this.mousePressed=!0,this.shiftPressed||(this.selection=!1,this.selectionAnchor=this.clickPos(this.mousePos),this.selectionStart=this.clickPos(this.mousePos)))}mouseUp(t){this.mousePressed=!1}keyType(t){this.focused&&this.keyQueue.push(t)}keyDown(t){"Shift"==t.key&&(this.shiftPressed=!0),this.mousePressed=!1}keyUp(t){"Shift"==t.key&&(this.shiftPressed=!1)}typeKey(t){if("ArrowLeft"==t.key)if(t.ctrlKey){let e=this.cursorPos,i=!1,s=!1;for(;!s;)0==e?s=!0:i?this.isLetter(e-1)||(s=!0):this.isLetter(e-1)&&(i=!0),e--;this.moveCursor(e+1-this.cursorPos,t.shiftKey)}else this.moveCursor(-1,t.shiftKey);else if("ArrowRight"==t.key)if(t.ctrlKey){let e=this.cursorPos,i=!1,s=!1,h=!1;for(;!h;)e==this.value.length?h=!0:i?s?this.isLetter(e)&&(h=!0):this.isLetter(e)||(s=!0):this.isLetter(e)&&(i=!0),e++;this.moveCursor(e-1-this.cursorPos,t.shiftKey)}else this.moveCursor(1,t.shiftKey);else if("Backspace"==t.key&&this.value.length>0)this.selectionStart!=this.cursorPos?this.removeSelected(!1):this.cursorPos>0&&(this.value=this.value.substring(0,this.cursorPos-1)+this.value.substring(this.cursorPos,this.value.length),this.cursorPos--,this.selectionStart=this.cursorPos,this.clipText(!1));else if("Delete"==t.key&&this.value.length>0)this.selectionStart!=this.cursorPos?this.removeSelected(!0):this.cursorPos<this.value.length&&(this.value=this.value.substring(0,this.cursorPos)+this.value.substring(this.cursorPos+1,this.value.length),this.clipText(!0));else if("Home"==t.key)this.moveCursor(-this.cursorPos,t.shiftKey);else if("End"==t.key)this.moveCursor(this.value.length-this.cursorPos,t.shiftKey);else if("Enter"==t.key)(this.allowEmptySubmit||this.value.length>0)&&this.onSubmit(this.value),this.clearOnSubmit&&this.clear(),this.blurOnSubmit&&this.blur();else if(1==t.key.length)if(t.ctrlKey){if("a"==t.key.toLowerCase())this.selection=!0,this.cursorPos=this.value.length,this.selectedText=[0,this.value.length],this.selectionStart=0;else if("c"==t.key.toLowerCase()){let t=this.value;this.selectionStart!=this.cursorPos&&(t=this.value.substring(this.selectionStart,this.cursorPos)),navigator.clipboard.writeText(t)}else if("v"==t.key.toLowerCase())this.selectionStart!=this.cursorPos&&this.removeSelected(),this.pasting=!0,navigator.clipboard.readText().then(t=>{let e="",i=this.maxLength-this.value.length;for(let s of t)this.maxLength>0&&e.length>=i||(e+="\n"==s?" ":s);this.value=this.value.substring(0,this.cursorPos)+e+this.value.substring(this.cursorPos,this.value.length),this.cursorPos+=e.length,this.selectionStart=this.cursorPos,this.clipText(!0),this.pasting=!1});else if("x"==t.key.toLowerCase()){let t=this.value;this.selectionStart!=this.cursorPos?(t=this.value.substring(this.selectionStart,this.cursorPos),this.removeSelected(!0)):(this.value="",this.cursorPos=0,this.selectionStart=this.cursorPos,this.clipText(!0)),navigator.clipboard.writeText(t)}}else this.selectionStart!=this.cursorPos&&this.removeSelected(),(0==this.maxLength||this.value.length<this.maxLength)&&(this.value=this.value.substring(0,this.cursorPos)+t.key+this.value.substring(this.cursorPos,this.value.length),this.cursorPos++,this.selectionStart=this.cursorPos,this.clipText(!0))}moveCursor(t,e){this.cursorPos+=t,this.cursorPos<0?(t-=this.cursorPos,this.cursorPos=0):this.cursorPos>this.value.length&&(t+=this.value.length-this.cursorPos,this.cursorPos=this.value.length),0!=t&&(this.timeSinceMoved=0),this.clipText(),this.mousePressed||this.shiftPressed||(this.selectionStart=this.cursorPos),e?0!=t&&(this.selection?(this.selectedText[1]=this.cursorPos,this.selectedText[0]==this.selectedText[1]&&(this.selection=!1)):(this.selection=!0,this.selectedText[0]=this.cursorPos-t,this.selectedText[1]=this.cursorPos)):this.selection=!1}removeSelected(t){this.selection=!1,this.selectionStart<this.cursorPos?(this.value=this.value.substring(0,this.selectionStart)+this.value.substring(this.cursorPos,this.value.length),this.cursorPos-=this.cursorPos-this.selectionStart,this.clipText(t)):(this.value=this.value.substring(0,this.cursorPos)+this.value.substring(this.selectionStart,this.value.length),this.clipText(t)),this.selectionStart=this.cursorPos}tryClip(t){let e,i="",s=0;if(this.fixedLeft=t,t){for(e=this.visibleText[0];s<=this.textW&&e<this.value.length;)i+=this.value[e],s=textWidth(i),s<=this.textW&&e++;this.visibleText[1]=e,this.cursorPos>this.visibleText[1]?(this.visibleText[1]=this.cursorPos,this.tryClip(!1)):0!=this.visibleText[0]&&this.visibleText[1]==this.value.length&&this.tryClip(!1)}else{for(e=this.visibleText[1]-1;s<=this.textW&&e>=0;)i=this.value[e]+i,s=textWidth(i),s<=this.textW&&e--;this.visibleText[0]=e+1,this.cursorPos<this.visibleText[0]?(this.visibleText[0]=this.cursorPos,this.tryClip(!0)):0==this.visibleText[0]&&this.tryClip(!0)}}clipText(t){null!=t&&(this.timeSinceMoved=0),push(),textSize(this.textSize),this.visibleText[1]>this.value.length&&(this.visibleText[1]=this.value.length),this.cursorPos>this.visibleText[1]?(this.visibleText[1]=this.cursorPos,this.tryClip(!1)):this.cursorPos<this.visibleText[0]?(this.visibleText[0]=this.cursorPos,this.tryClip(!0)):null!=t?this.tryClip(t):this.tryClip(this.fixedLeft),this.visibleTextString=this.value.substring(this.visibleText[0],this.visibleText[1]),this.visibleTextWidth=textWidth(this.visibleTextString),pop()}clickPos(t){let e=t.x-this.padding;if(this.fixedLeft||(e+=this.visibleTextWidth-this.textW),e<0)return this.visibleText[0]>0&&frameCount%5==0?this.visibleText[0]-1:this.visibleText[0];if(e<this.visibleTextWidth){let t=this.visibleText[0],i="",s=0;for(push(),textSize(this.textSize);s<=e&&t<this.visibleText[1];)i+=this.value[t],s=textWidth(i),s<=e&&t++;return pop(),t}return this.visibleText[1]<this.value.length&&frameCount%5==0?this.visibleText[1]+1:this.visibleText[1]}isHovered(t=this.mousePos){return t.x>0&&t.y>-this.height&&t.x<this.width&&t.y<0}clear(){this.value="",this.timeSinceMoved=0,this.cursorPos=0,this.selection=!1,this.selectionStart=this.cursorPos,this.clipText()}focus(){this.focused=!0,this.timeSinceMoved=0,this.onFocus()}blur(){this.focused=!1,this.shiftPressed=!1,this.mousePressed=!1,this.onBlur()}changeScreen(t){t&&this.blur()}show(){let t=this.getColour("fill");-1!=t?fill(t):noFill();let e=this.getColour("stroke");-1!=e?(stroke(e),strokeWeight(1)):noStroke(),rect(.5*this.width,.5*-this.height,this.width,this.height),textSize(this.textSize);let i=this.getColour("selection");if(-1!=i){let t=this.selectionStart,e=this.cursorPos;if(t>e){let i=t;t=e,e=i}if(this.selectionStart!=this.cursorPos&&t<this.visibleText[1]&&e>this.visibleText[0]){let s=Math.max(t,this.visibleText[0]),h=Math.min(e,this.visibleText[1]),o=this.padding;this.fixedLeft||(o+=this.textW-this.visibleTextWidth);let r=textWidth(this.value.substring(this.visibleText[0],s)),l=textWidth(this.value.substring(this.visibleText[0],h));noStroke(),fill(i),rect(o+.5*(r+l),.5*-this.height,l-r,this.textSize)}}if(textAlign(LEFT),noStroke(),this.value.length>0)fill(this.getColour("text")),this.fixedLeft?text(this.visibleTextString,this.padding,-.5*this.height+this.textSize/3):text(this.visibleTextString,this.padding+this.textW-this.visibleTextWidth,-.5*this.height+this.textSize/3);else if(!this.focused){let t=this.getColour("default");-1!=t?fill(t):fill(this.getColour("text")),text(this.default,this.padding,-.5*this.height+this.textSize/3)}if(this.focused&&this.cursorPos>=this.visibleText[0]&&this.cursorPos<=this.visibleText[1]&&this.timeSinceMoved%60<30){let t=this.padding+textWidth(this.value.substring(this.visibleText[0],this.cursorPos));this.fixedLeft||(t+=this.textW-this.visibleTextWidth),stroke(this.getColour("text")),strokeWeight(2),line(t,-this.padding,t,-this.padding-this.textSize)}}isLetter(t){let e=this.value[t].toLowerCase().charCodeAt();return e>=97&&e<=122}};h.Textbox;const n=["setupUI","addScreen","getScreen","setScreen","addOverlay","openOverlay","closeOverlay","closeAllOverlays","getActiveScreen","addElement","getElement","updateUI","drawUI","setFont","setSounds","resizeUI","addTheme","setTheme"];var u=function(t){window.p5ui=new h(t),function(t){for(let e of n)window[e]=(...i)=>t[e](...i)}(window.p5ui)};window.P5UI=h,window.createUI=u}]);